<UserControl xmlns:dxsps="http://schemas.devexpress.com/winfx/2008/xaml/spreadsheet" 
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
             xmlns:d="http://sche mas.microsoft.com/expression/blend/2008" 
             xmlns:local="clr-namespace:JxcApplication.Views.Mail"
             xmlns:dxre="http://schemas.devexpress.com/winfx/2008/xaml/richedit" 
             xmlns:dxb="http://schemas.devexpress.com/winfx/2008/xaml/bars" 
             xmlns:dxr="http://schemas.devexpress.com/winfx/2008/xaml/ribbon"
    xmlns:native="http://schemas.devexpress.com/winfx/2008/xaml/core/internal"
    xmlns:ts="clr-namespace:JxcApplication.TemplateSelector"
    xmlns:dxmvvm="http://schemas.devexpress.com/winfx/2008/xaml/mvvm"
    xmlns:dx="http://schemas.devexpress.com/winfx/2008/xaml/core"
    x:Class="JxcApplication.Views.Mail.EditMailView"
             mc:Ignorable="d" 
             d:DesignHeight="300" d:DesignWidth="300">
    <UserControl.Resources>
        <dxre:HtmlToContentConverter x:Key="HtmlToContentConverter"/>
        <native:TemplatesDictionary x:Key="editTemplate">
            <!-- ReSharper disable once Xaml.RedundantResource -->
            <DataTemplate x:Key="Doc">
                <dx:LoadingDecorator>
                    <dxre:RichEditControl x:Name="RichEditControlDoc" ActiveViewType="Simple" ReadOnly="True">
                        <dxmvvm:Interaction.Behaviors>
                            <dxmvvm:EventToCommand EventName="Loaded" SourceName="RichEditControlDoc" 
                                               Command="{Binding ControlLoadedCommand}"
                                               CommandParameter="{Binding ElementName=RichEditControlDoc}"/>
                        </dxmvvm:Interaction.Behaviors>
                    </dxre:RichEditControl>
                </dx:LoadingDecorator>
            </DataTemplate>
            <!-- ReSharper disable once Xaml.RedundantResource -->
            <DataTemplate x:Key="Excel">
                <dx:LoadingDecorator>
                    <dxsps:SpreadsheetControl x:Name="SpreadsheetControlExcel" ShowTabSelector="False" ReadOnly="True">
                    <dxmvvm:Interaction.Behaviors>
                        <dxmvvm:EventToCommand EventName="Loaded" SourceName="SpreadsheetControlExcel" 
                                               Command="{Binding ControlLoadedCommand}"
                                               CommandParameter="{Binding ElementName=SpreadsheetControlExcel}"/>
                    </dxmvvm:Interaction.Behaviors>
                </dxsps:SpreadsheetControl>
                </dx:LoadingDecorator>
            </DataTemplate>
        </native:TemplatesDictionary>
    </UserControl.Resources>
    <Grid>
        <ContentPresenter Content="{Binding Path=EditPreview}">
            <ContentPresenter.ContentTemplateSelector>
                <ts:MailEditPreviewTemplateSelector Templates="{StaticResource editTemplate}"/>
            </ContentPresenter.ContentTemplateSelector>
        </ContentPresenter>
    </Grid>
    <!--<dxre:RichEditControl></dxre:RichEditControl>-->
</UserControl>

